module minibcs 1.3;

require {
  type sandbox_t;
  type urandom_device_t;
  type tmpfs_t;
  type random_device_t;

  class dir { getattr read search open };
  class chr_file open;
  class file open;
  class lnk_file { getattr read };
  class filesystem getattr;
}

files_search_home(sandbox_t);
kernel_getattr_proc(sandbox_t);
kernel_read_system_state(sandbox_t);

allow sandbox_t tmpfs_t:dir read;
allow sandbox_t random_device_t:chr_file open;
allow sandbox_t urandom_device_t:chr_file open;
